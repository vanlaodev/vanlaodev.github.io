(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1651290b"],{"96ec":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return null!=t.ctx?a("b-modal",{attrs:{title:t.modalTitle,"ok-title":t.$t("confirm"),"cancel-title":t.$t("cancel")},on:{ok:t.onConfirm,change:t.onChange},model:{value:t.ctx.visible,callback:function(e){t.$set(t.ctx,"visible",e)},expression:"ctx.visible"}},[a("p",{staticClass:"my-1"},[t._v(t._s(t.ctx.message))])]):t._e()},i=[],s={name:"ConfirmDialog",props:["ctx"],computed:{modalTitle:function(){return null!=this.ctx&&null!=this.ctx.title&&this.ctx.title.length>0?this.ctx.title:this.$t("confirmation")}},methods:{onChange:function(t){null!=this.ctx&&this.ctx.resolve&&!t&&this.ctx.resolve(!1)},onConfirm:function(){null!=this.ctx&&this.ctx.resolve(!0)}}},n=s,o=a("2877"),l=Object(o["a"])(n,r,i,!1,null,null,null);e["a"]=l.exports},b361:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-card",{staticClass:"shadow-sm",attrs:{title:t.$t("editInventoryForm")}},[t.originalMaster&&!t.loading?a("b-form",{staticClass:"mt-3",on:{submit:function(e){return e.preventDefault(),t.savedata(e)}}},[a("div",{staticClass:"row"},[a("b-form-group",{staticClass:"col-md-6 required",attrs:{label:t.$t("id"),"label-for":"input-id"}},[a("b-form-input",{attrs:{id:"input-id",value:t.originalMaster.id,readonly:"",required:""}})],1),t.selectedDept?a("b-form-group",{staticClass:"col-md-6 required",attrs:{label:t.$t("department"),"label-for":"input-dept"}},[a("b-form-input",{attrs:{id:"input-dept",value:t.selectedDept.text,readonly:"",required:""}})],1):t._e()],1),a("div",{staticClass:"row"},[a("b-form-group",{staticClass:"col-md-6 required",attrs:{label:t.$t("title"),"label-for":"input-title"}},[a("b-form-input",{attrs:{id:"input-title",required:"",autofocus:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),a("b-form-group",{staticClass:"col-md-6 required",attrs:{label:t.$t("status"),"label-for":"select-status"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedStatus,expression:"selectedStatus"}],staticClass:"form-control",attrs:{id:"select-status"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedStatus=e.target.multiple?a:a[0]}}},t._l(t.statusList,(function(e){return a("option",{key:e.value,domProps:{value:e.value}},[t._v(" "+t._s(e.text)+" ")])})),0)])],1),a("div",{staticClass:"row"},[a("b-form-group",{staticClass:"col-md-6 required",attrs:{label:t.$t("from"),"label-for":"dtp-from"}},[a("b-form-datepicker",{attrs:{id:"dtp-from",min:t.minDtpFrom},on:{input:t.onDtpFromUpdated},model:{value:t.dtpFrom,callback:function(e){t.dtpFrom=e},expression:"dtpFrom"}})],1),a("b-form-group",{staticClass:"col-md-6 required",attrs:{label:t.$t("to"),"label-for":"dtp-to"}},[a("b-form-datepicker",{attrs:{id:"dtp-to",min:t.minDtpTo},model:{value:t.dtpTo,callback:function(e){t.dtpTo=e},expression:"dtpTo"}})],1)],1),a("b-form-group",{attrs:{label:t.$t("remark"),"label-for":"input-remark"}},[a("b-form-textarea",{attrs:{id:"input-remark"},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1),a("b-button",{staticClass:"mr-2",attrs:{disabled:t.saving,type:"submit",variant:"primary"}},[t._v(t._s(t.$t("save")))]),a("b-button",{attrs:{disabled:t.saving,variant:"secondary"},on:{click:function(e){return e.preventDefault(),t.backToinquiry(e)}}},[t._v(t._s(t.$t("cancel")))])],1):t.loading?a("div",{staticClass:"mt-4"},[a("strong",[t._v(t._s(t.$t("loading"))+"...")])]):t._e(),a("confirm-dialog",{attrs:{ctx:t.confirmDialogCtx}}),a("message-dialog",{attrs:{ctx:t.msgDialogCtx}})],1),t.loading?t._e():a("b-card",{staticClass:"shadow-sm mt-3",attrs:{title:t.$t("inventoryOfAssets")}},[a("b-button",{staticClass:"mb-2 mr-2",attrs:{variant:"success"},on:{click:t.openModal}},[a("b-icon",{attrs:{icon:"plus-circle","aria-hidden":"true"}}),t._v(" "+t._s(t.$t("add"))+" ")],1),a("b-table",{staticClass:"mt-3",attrs:{responsive:"",hover:"",items:t.details,fields:t.detailsFields,"sort-by":t.detailsSortBy,"sort-desc":t.detailsSortDesc},on:{"update:sortBy":function(e){t.detailsSortBy=e},"update:sort-by":function(e){t.detailsSortBy=e},"update:sortDesc":function(e){t.detailsSortDesc=e},"update:sort-desc":function(e){t.detailsSortDesc=e}},scopedSlots:t._u([{key:"cell(actions)",fn:function(e){return[t.canEditDetails&&e.item.canEdit()?a("b-button",{staticClass:"p-0",attrs:{variant:"link",size:"sm"},on:{click:function(a){return t.showConfirmDeleteDetailModal(e.item.id)}}},[a("b-icon",{attrs:{icon:"trash-fill","aria-hidden":"true"}}),t._v(" "+t._s(t.$t("delete"))+" ")],1):t._e()]}}],null,!1,930725622)})],1),a("b-modal",{attrs:{id:"insert-modal",size:"lg",title:t.$t("add")}},[a("b-table",{staticClass:"mt-3",attrs:{responsive:"",hover:"",items:t.adddetails,fields:t.detailsFields,"sort-by":t.detailsSortBy,"sort-desc":t.detailsSortDesc},on:{"update:sortBy":function(e){t.detailsSortBy=e},"update:sort-by":function(e){t.detailsSortBy=e},"update:sortDesc":function(e){t.detailsSortDesc=e},"update:sort-desc":function(e){t.detailsSortDesc=e}},scopedSlots:t._u([{key:"cell(actions)",fn:function(){return[a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"checkbox",value:"",id:"flexCheckDefault"}}),a("label",{staticClass:"form-check-label",attrs:{for:"flexCheckDefault"}},[t._v(" "+t._s(t.$t("add"))+" ")])])]},proxy:!0}])})],1)],1)},i=[],s=a("c964"),n=a("f3f3"),o=(a("96cf"),a("7db0"),a("d3b7"),a("5319"),a("ac1f"),a("5a0c")),l=a("2f62"),c=a("d5bc"),u=a("96ec"),d={components:{MessageDialog:c["a"],ConfirmDialog:u["a"]},data:function(){return{originalMaster:null,title:"",dtpFrom:o().format("YYYY-MM-DD"),dtpTo:o().format("YYYY-MM-DD"),selectedStatus:"",remark:"",saving:!1,loading:!1,msgDialogCtx:{visible:!1,title:"",message:"",resolve:null},confirmDialogCtx:{visible:!1,title:"",message:"",resolve:null},details:[],detailsSortBy:"assetId",detailsSortDesc:!1,adddetails:[]}},computed:Object(n["a"])(Object(n["a"])({},Object(l["d"])(["deptList"])),{},{minDtpFrom:function(){return o().format("YYYY-MM-DD")},minDtpTo:function(){return this.dtpFrom},selectedDept:function(){var t=this;return this.originalMaster?this.deptList.find((function(e){return e.value==t.originalMaster.deptId})):null},statusList:function(){return[{value:"ACTIVE",text:this.$t("active")},{value:"INVALID",text:this.$t("invalid")}]},canEditDetails:function(){return!0},detailsFields:function(){var t=this;return[{key:"id",label:this.$t("id"),sortable:!0},{key:"assetId",label:this.$t("assetId"),sortable:!0},{key:"brand",label:this.$t("brand"),sortable:!0},{key:"description",label:this.$t("description"),sortable:!0},{key:"remark",label:this.$t("remark"),sortable:!0,formatter:function(e,a,r){switch(t.$i18n.locale){case"en":return r.remarkPt;default:return r.remarkZh}}},{key:"result",label:this.$t("result"),sortable:!0,formatter:function(e,a,r){return r.actionResult?r.actionResult:t.$t("notInventoried")}},{key:"actions",label:this.$t("actions")}]}}),mounted:function(){this.getInventoryMaster()},methods:{showMsgDialog:function(t,e){var a=this;return new Promise((function(r){a.msgDialogCtx.title=e,a.msgDialogCtx.message=t,a.msgDialogCtx.resolve=r,a.msgDialogCtx.visible=!0}))},showConfirmDialog:function(t,e){var a=this;return new Promise((function(r){a.confirmDialogCtx.title=e,a.confirmDialogCtx.message=t,a.confirmDialogCtx.resolve=r,a.confirmDialogCtx.visible=!0}))},showConfirmDeleteDetailModal:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.details.find((function(e){return e.id==t})),a.next=3,e.showConfirmDialog(e.$t("fmt_msg_confirmDeleteInventoryDetail",r));case 3:if(i=a.sent,!i){a.next=7;break}return a.next=7,e.deleteDetail(t);case 7:case"end":return a.stop()}}),a)})))()},deleteDetail:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.$api.inventoryApi.deleteDetail(t);case 3:r=0;case 4:if(!(r<e.details.length)){a.next=11;break}if(e.details[r].id!=t){a.next=8;break}return e.$delete(e.details,r),a.abrupt("break",11);case 8:r++,a.next=4;break;case 11:e.$root.$bvToast.toast(e.$t("msg_operationSuccess"),{title:e.$t("message"),variant:"success",autoHideDelay:2e3,solid:!0}),a.next=18;break;case 14:return a.prev=14,a.t0=a["catch"](0),a.next=18,e.showMsgDialog(a.t0,e.$t("error"));case 18:case"end":return a.stop()}}),a,null,[[0,14]])})))()},getInventoryMaster:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.$route.params.id,!a){e.next=37;break}if(!t.loading){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,t.loading=!0,e.next=8,t.$api.inventoryApi.getMasterById(a);case 8:if(r=e.sent,!r){e.next=22;break}return t.title=r.title,t.remark=r.remark,t.selectedStatus=t.statusList.find((function(t){return t.value==r.status})).value,t.dtpFrom=r.fromTime.format("YYYY-MM-DD"),t.dtpTo=r.endTime.format("YYYY-MM-DD"),e.next=17,t.$api.inventoryApi.searchDetail({masterId:a});case 17:i=e.sent,t.details=null==i?[]:i,t.originalMaster=r,e.next=25;break;case 22:return e.next=24,t.showMsgDialog(t.$t("msg_recordNotFound"));case 24:t.backToinquiry();case 25:e.next=32;break;case 27:return e.prev=27,e.t0=e["catch"](4),e.next=31,t.showMsgDialog(e.t0,t.$t("error"));case 31:t.backToinquiry();case 32:return e.prev=32,t.loading=!1,e.finish(32);case 35:e.next=38;break;case 37:t.backToinquiry();case 38:case"end":return e.stop()}}),e,null,[[4,27,32,35]])})))()},onDtpFromUpdated:function(){this.dtpFrom>this.dtpTo&&(this.dtpTo=this.dtpFrom)},savedata:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.saving){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t.saving=!0,e.next=6,t.$api.inventoryApi.updateMaster({id:t.originalMaster.id,deptId:t.originalMaster.deptId,status:t.selectedStatus,fromTime:o(t.dtpFrom).format("YYYY/MM/DD"),endTime:o(t.dtpTo).format("YYYY/MM/DD"),title:t.title,remark:t.remark});case 6:t.$root.$bvToast.toast(t.$t("msg_operationSuccess"),{title:t.$t("message"),variant:"success",autoHideDelay:2e3,solid:!0}),t.backToinquiry(),e.next=14;break;case 10:return e.prev=10,e.t0=e["catch"](2),e.next=14,t.showMsgDialog(e.t0,t.$t("error"));case 14:return e.prev=14,t.saving=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,10,14,17]])})))()},backToinquiry:function(){this.$router.replace({name:"InventoryFormManagement"})},openModal:function(){this.$bvModal.show("insert-modal"),this.loadAddData()},loadAddData:function(){}}},m=d,f=a("2877"),p=Object(f["a"])(m,r,i,!1,null,null,null);e["default"]=p.exports},d5bc:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return null!=t.ctx?a("b-modal",{attrs:{title:t.modalTitle,"ok-only":"","ok-title":t.$t("ok")},on:{change:t.onChange},model:{value:t.ctx.visible,callback:function(e){t.$set(t.ctx,"visible",e)},expression:"ctx.visible"}},[a("p",{staticClass:"my-1"},[t._v(t._s(t.ctx.message))])]):t._e()},i=[],s={name:"MessageDialog",props:["ctx"],computed:{modalTitle:function(){return null!=this.ctx&&null!=this.ctx.title&&this.ctx.title.length>0?this.ctx.title:this.$t("message")}},methods:{onChange:function(t){null!=this.ctx&&this.ctx.resolve&&!t&&this.ctx.resolve()}}},n=s,o=a("2877"),l=Object(o["a"])(n,r,i,!1,null,null,null);e["a"]=l.exports}}]);
//# sourceMappingURL=chunk-1651290b.9ec4fbd7.js.map